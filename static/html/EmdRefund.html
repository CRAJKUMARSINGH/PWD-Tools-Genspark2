<!DOCTYPE html>

<html lang="en">

<head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta charset="UTF-8">

    <meta name="viewport" content="width=210mm, height=297mm">

    <title>Hand Receipt (RPWA 28)</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>

        body {

            font-family: sans-serif;

            margin: 0;

            max-width: 210mm;

            overflow-x: hidden;

        }



        .container {

            width: 210mm;

            height: 297mm;

            margin: 0 auto;

            border: 2px solid #ccc;

            padding: 20px;

            box-sizing: border-box;

            position: relative;

            page-break-after: avoid;

        }



        .header {

            text-align: center;

            margin-bottom: 2px;

        }



        .details {

            margin-bottom: 1px;

        }



        .amount-words {

            font-style: italic;

        }



        .signature-area {

            width: 100%;

            border-collapse: collapse;

            margin-top: 20px;

        }



        .signature-area td, .signature-area th {

            border: 1px solid #ccc;

            padding: 5px;

            text-align: left;

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        .offices {

            width: 100%;

            border-collapse: collapse;

            margin-top: 20px;

        }



        .offices td, .offices th {

            border: 1px solid black;

            padding: 5px;

            text-align: left;

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        .input-field {

            border-bottom: 1px dotted #ccc;

            padding: 3px;

            width: calc(100% - 10px);

            display: inline-block;

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        @media print {

            html, body {

                width: 210mm;

                max-width: 210mm;

                height: 297mm;

                margin: 0;

                padding: 0;

                overflow: hidden;

            }

            .container {

                border: none;

                width: 210mm;

                max-width: 210mm;

                height: 297mm;

                min-height: 297mm;

                margin: 0;

                padding: 10mm;

                page-break-after: never;

                page-break-inside: avoid;

                page-break-before: avoid;

                box-sizing: border-box;

                overflow: hidden;

                position: relative;

            }



            .input-field {

                border: none;

            }



            body {

                margin: 0;

                height: 100%;

                overflow: hidden;

            }

            

            /* Ensure only the first page is printed */

            .container:not(:first-child) {

                display: none;

            }

            

            /* Prevent any additional content from appearing */

            body::after {

                display: none !important;

            }

            

            /* Ensure the container is visible for printing */

            .container {

                display: block !important;

            }

            

            /* Prevent overflow on print */

            * {

                overflow: hidden !important;

                word-wrap: break-word !important;

                overflow-wrap: break-word !important;

            }

            

            /* Force all content to stay within page boundaries */

            * {

                max-height: inherit;

            }

            

            /* Ensure tables don't break across pages */

            table {

                page-break-inside: avoid;

                break-inside: avoid;

            }

            

            /* Ensure the bottom-left box stays within bounds */

            .bottom-left-box {

                page-break-inside: avoid;

                break-inside: avoid;

                position: absolute;

                bottom: 40mm;

                left: 40mm;

                border: 2px solid black;

                padding: 10px;

                width: calc(210mm - 80mm);

                max-width: calc(210mm - 80mm);

                text-align: left;

                height: auto;

                box-sizing: border-box;

            }

            

            @page {

                size: A4 portrait;

                margin: 0;

                page-break-after: never;

            }

            

            /* Hide interactive elements when printing */

            #prompt-container {

                display: none !important;

            }

        }



        .bottom-left-box {

            position: absolute;

            bottom: 40mm;

            left: 40mm;

            border: 2px solid black;

            padding: 10px;

            width: 300px;

            text-align: left;

            height: auto;

            max-width: calc(210mm - 80mm);

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        .bottom-left-box p {

            margin: 3px 0;

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        .bottom-left-box .blue-text {

            color: blue;

            word-wrap: break-word;

            overflow-wrap: break-word;

        }



        #prompt-container {

            position: fixed;

            top: 50%;

            left: 50%;

            transform: translate(-50%, -50%);

            background-color: #F5F6F5;

            padding: 20px;

            border-radius: 10px;

            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);

            z-index: 1000;

            display: grid;

            grid-template-columns: repeat(3, 1fr);

            gap: 10px;

            width: 400px;

            font-family: Arial, sans-serif;

        }



        #prompt-container label {

            grid-column: span 1;

            font-weight: bold;

            color: #333;

            align-self: center;

        }



        #prompt-container input {

            grid-column: span 2;

            padding: 8px;

            border: 1px solid #D1D1D1;

            border-radius: 5px;

            font-size: 14px;

            transition: border-color 0.3s ease;

        }



        #prompt-container input:focus {

            border-color: #C71585;

            outline: none;

        }



        #prompt-container button {

            grid-column: span 3;

            background-color: #C71585;

            color: #FFFFFF;

            padding: 10px;

            border: none;

            border-radius: 8px;

            font-size: 16px;

            font-weight: bold;

            cursor: pointer;

            transition: background-color 0.3s ease;

        }



        #prompt-container button:hover {

            background-color: #9B0E66;

        }

        

        #download-button {

            grid-column: span 3;

            background-color: #4CAF50;

            color: white;

            padding: 10px;

            border: none;

            border-radius: 8px;

            font-size: 16px;

            font-weight: bold;

            cursor: pointer;

            transition: background-color 0.3s ease;

            margin-top: 10px;

            display: none;

        }

        

        #download-button:hover {

            background-color: #45a049;

        }

        

        #print-button {

            grid-column: span 3;

            background-color: #2196F3;

            color: white;

            padding: 10px;

            border: none;

            border-radius: 8px;

            font-size: 16px;

            font-weight: bold;

            cursor: pointer;

            transition: background-color 0.3s ease;

            margin-top: 10px;

            display: none;

        }

        

        #print-button:hover {

            background-color: #0b7dda;

        }

        

        #auto-download-toggle {

            grid-column: span 3;

            margin-top: 10px;

            display: none;

        }

        

        #auto-download-toggle label {

            font-weight: bold;

            color: #333;

        }

        

        /* Additional styles to prevent text overflow */

        p, h1, h2, h3, h4, h5, h6, span, div {

            word-wrap: break-word;

            overflow-wrap: break-word;

            max-width: 100%;

        }

        

        table {

            table-layout: fixed;

            width: 100%;

        }

        

        td, th {

            word-wrap: break-word;

            overflow-wrap: break-word;

        }

    </style>

</head>



<body>

    <div id="prompt-container">

        <label for="payee">Payee Name:</label>

        <input type="text" id="payee">

        <label for="amount">Amount:</label>

        <input type="number" id="amount">

        <label for="work">Name of Work:</label>

        <input type="text" id="work">

        <button id="generate-button">Generate Receipt</button>
        
        <button id="print-button" style="display:none;">Print Receipt</button>
        
        <button id="download-button" style="display:none;">Download as PDF</button>
        
        <div id="auto-download-toggle" style="display:none;">
            <label>
                <input type="checkbox" id="auto-download-checkbox" checked> 
                Auto-download PDF after generation
            </label>
        </div>

    </div>

    <div class="container" id="receipt-content"></div>



    <script>

        function convertNumberToWords(num) {

            const ones = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine"];

            const tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];

            const teens = ["Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];

            const crore = " Crore ";

            const lakh = " Lakh ";

            const thousand = " Thousand ";

            const hundred = " Hundred ";

            const and = " and ";



            if (num === 0) return "Zero";



            let words = "";



            if (Math.floor(num / 10000000)) {

                words += convertNumberToWords(Math.floor(num / 10000000)) + crore;

                num %= 10000000;

            }



            if (Math.floor(num / 100000)) {

                words += convertNumberToWords(Math.floor(num / 100000)) + lakh;

                num %= 100000;

            }



            if (Math.floor(num / 1000)) {

                words += convertNumberToWords(Math.floor(num / 1000)) + thousand;

                num %= 1000;

            }



            if (Math.floor(num / 100)) {

                words += convertNumberToWords(Math.floor(num / 100)) + hundred;

                num %= 100;

            }



            if (num > 0) {

                if (words !== "") words += and;

                if (num < 10) words += ones[num];

                else if (num < 20) words += teens[num - 10];

                else {

                    words += tens[Math.floor(num / 10)];

                    if (num % 10 > 0) words += " " + ones[num % 10];

                }

            }



            return words;

        }



        function generateReceiptHTML(payee, amount, work) {

            const amountInWords = convertNumberToWords(parseFloat(amount));

            return `

                <div class="header">

                    <h2>Payable to: - ${payee} ( Electric Contractor)</h2>

                    <h2>HAND RECEIPT (RPWA 28)</h2>

                    <p>(Referred to in PWF&A Rules 418,424,436 & 438)</p>

                    <p>Division - PWD Electric Division, Udaipur</p>

                </div>

                <div class="details">

                    <p>(1)Cash Book Voucher No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

                    <p>(2)Cheque No. and Date &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

                    <p>(3) Pay for ECS Rs.${amount}/- (Rupees <span id="amount-words" class="amount-words">${amountInWords} only</span>)</p>

                    <p>(4) Paid by me</p>

                    <p>(5) Received from The Executive Engineer PWD Electric Division, Udaipur the sum of Rs. ${amount}/- (Rupees <span id="amount-words" class="amount-words">${amountInWords} only</span>)</p>

                    <p> Name of work for which payment is made: <span id="work-name" class="input-field">${work}</span></p>

                    <p> Chargeable to Head:- 8443 [EMD-Refund] </p>   

                    <table class="signature-area">

                        <tr>

                            <td>Witness</td>

                            <td>Stamp</td>

                            <td>Signature of payee</td>

                        </tr>

                        <tr>

                            <td>Cash Book No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Page No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>

                            <td></td>

                            <td></td>

                        </tr>

                    </table>

                    <table class="offices">

                        <tr>

                            <td>For use in the Divisional Office</td>

                            <td>For use in the Accountant General's office</td>

                        </tr>

                        <tr>

                            <td>Checked</td>

                            <td>Audited/Reviewed</td>

                        </tr>

                        <tr>

                            <td>Accounts Clerk</td>

                            <td>

                                DA &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Auditor &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Supdt. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; G.O.

                            </td>

                        </tr>

                    </table>

                </div>

                <div class="bottom-left-box">

                    <p class="blue-text"> Passed for Rs. ${amount}</p>

                    <p class="blue-text"> In Words Rupees: ${amountInWords} Only</p>

                    <p class="blue-text"> Chargeable to Head:- 8443 [EMD-Refund]</p>

                </div>

            `;

}



function downloadPDF(payee, amount) {

    const element = document.getElementById('receipt-content');

    const opt = {

        margin: 1,

        filename: `EMD_Refund_Receipt_${payee.replace(/\s+/g, '_')}_${amount}.pdf`,

        image: { type: 'jpeg', quality: 0.98 },

        html2canvas: { scale: 2, useCORS: true },

        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },

        pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }

    };

    

    // Generate and download PDF

    html2pdf().set(opt).from(element).save();

}



document.getElementById('generate-button').addEventListener('click', function() {

    const enteredPayee = document.getElementById('payee').value;

    const enteredAmount = parseFloat(document.getElementById('amount').value);

    const enteredWork = document.getElementById('work').value;

    if (enteredPayee && !isNaN(enteredAmount) && enteredWork) {

        const receiptHTML = generateReceiptHTML(enteredPayee, enteredAmount, enteredWork);

        document.getElementById('receipt-content').innerHTML = receiptHTML;

        document.getElementById('prompt-container').style.display = 'none';

        // Show action buttons

        const printButton = document.getElementById('print-button');

        const downloadButton = document.getElementById('download-button');

        const autoDownloadToggle = document.getElementById('auto-download-toggle');

        printButton.style.display = 'block';

        downloadButton.style.display = 'block';

        autoDownloadToggle.style.display = 'block';

        

        printButton.onclick = function() {

            window.print();

        };

        

        downloadButton.onclick = function() {

            downloadPDF(enteredPayee, enteredAmount);

        };

        

        // Auto-download if checkbox is checked

        const autoDownloadCheckbox = document.getElementById('auto-download-checkbox');

        if (autoDownloadCheckbox && autoDownloadCheckbox.checked) {

            // Small delay to ensure content is fully rendered

            setTimeout(function() {

                downloadPDF(enteredPayee, enteredAmount);

            }, 500);

        }

    } else {

        alert("Please provide all required information. Amount must be a number.");

    }

});

</script>

</body>

</html>